type: object
title: Risk metadata
description: Risk metadata used for 3D Secure and risk scoring.
properties:
  ipAddress:
    description: Customer's IP address.
    type:
      - 'string'
      - 'null'
    format: ipv4 or ipv6
    example: 93.92.91.90
  fingerprint:
    description: |-
      Customer's device fingerprint.
      A device fingerprint is a unique token that is used to identify the customer.
      The device fingerprint is generated based on device attributes, such as: hardware,
      software, IP address, language, browser, and more.
    type:
      - 'string'
      - 'null'
    maxLength: 50
    example: pIUt3xbgX3l9g3YDiLbx
  httpHeaders:
    oneOf:
      - $ref: ./HttpHeaders.yaml
      - type: 'null'
  browserData:
    type:
      - 'object'
      - 'null'
    description: Browser data used for 3D Secure and risk scoring.
    required:
      - colorDepth
      - isJavaEnabled
      - language
      - screenWidth
      - screenHeight
      - timeZoneOffset
    properties:
      colorDepth:
        description: |-
          Browser color depth in bits per pixel.
          This value is obtained using the `screen.colorDepth` property.
        type: integer
        minimum: 1
        maximum: 48
        example: 24
      isJavaEnabled:
        description: |-
          Specifies if Java is enabled in a browser.
          This value is obtained from the `navigator.javaEnabled` property.
        type: boolean
      language:
        description: |-
          Browser language settings.
          This value is obtained from the `navigator.language` property.
        type: string
        example: en-US
        maxLength: 8
      screenWidth:
        description: |-
          Width of the browser screen.
          This value is obtained from the `screen.width` property.
        type: integer
        minimum: 0
        maximum: 65535
        example: 1920
      screenHeight:
        description: |-
          Height of the browser screen.
          This value is obtained from the `screen.height` property.
        type: integer
        minimum: 0
        maximum: 65535
        example: 1080
      timeZoneOffset:
        description: |-
          Browser time zone offset in minutes from UTC.
          A positive offset indicates that the local time is behind UTC.
          A negative offset indicates that the local time is ahead of UTC.
          You can find this value using the `(new Date()).getTimezoneOffset()` property.
        type: integer
        minimum: -1410
        maximum: 1410
        example: 300
      isAdBlockEnabled:
        description: Specifies if the usage of ad block has been detected in the browser.
        type: boolean
  extraData:
    type:
      - 'object'
      - 'null'
    description: Third-party data used for risk scoring.
    properties:
      kountFraudSessionId:
        description: Alpha-numeric `fraudSessionId` as provided by the Kount SDK.
        type: string
        minimum: 10
        maximum: 32
        example: abcdefg12345abababab123456789012
      payPalMerchantSessionId:
        description: PayPal `MerchantSessionID` as generated by the PayPal Fraudnet SDK.
        type: string
        minimum: 1
        maximum: 64
        example: dd65ratxc5qv15iph3vyoq7l6davuowa
      threatMetrixSessionId:
        description: Temporary identifier that is unique to the visitor session and passed to ThreatMetrix.
        pattern: '[a-zA-Z0-9_-]+'
        type: string
        minimum: 1
        maximum: 128
        example: dd65ratxc5qv15iph3vyoq7l6davuowadd65ratxc5qv15iph3vyoq7l6davuowa
  isProxy:
    description: Specifies if the customer's IP address is related to a proxy.
    type: boolean
    readOnly: true
  isVpn:
    description: Specifies if the customer's IP address is related to a VPN.
    type: boolean
    readOnly: true
  isTor:
    description: Specifies if the customer's IP address is related to TOR.
    type: boolean
    readOnly: true
  isHosting:
    description: Specifies if the customer's IP address is related to hosting.
    type: boolean
    readOnly: true
  hostingName:
    description: Name of the data center or hosting provider, if available.
    type:
      - 'string'
      - 'null'
    readOnly: true
  isp:
    description: Internet Service Provider (ISP) name, if available.
    type:
      - 'string'
      - 'null'
    readOnly: true
  country:
    description: Country ISO Alpha-2 code of the specified IP address.
    maxLength: 2
    type:
      - 'string'
      - 'null'
    readOnly: true
    example: US
  region:
    description: Region of the specified IP address.
    type:
      - 'string'
      - 'null'
    readOnly: true
    example: NY
  city:
    description: City of the specified IP address.
    type:
      - 'string'
      - 'null'
    readOnly: true
    example: New York
  latitude:
    description: Latitude of the specified IP address.
    type: number
    format: double
    readOnly: true
  longitude:
    description: Longitude of the specified IP address.
    type:
      - 'number'
      - 'null'
    format: double
    readOnly: true
  postalCode:
    description: Postal code of the specified IP address.
    type:
      - 'string'
      - 'null'
    maxLength: 10
    readOnly: true
  timeZone:
    description: Time zone of the specified IP address.
    type:
      - 'string'
      - 'null'
    readOnly: true
    example: America/New_York
  accuracyRadius:
    description: Accuracy radius of the specified IP address, in kilometers.
    type:
      - 'integer'
      - 'null'
    readOnly: true
  distance:
    description: Distance between the customer's IP address and the billing address geolocation, in kilometers.
    type:
      - 'integer'
      - 'null'
    readOnly: true
  hasMismatchedBillingAddressCountry:
    description: Specifies if the customer's billing address country and geo-IP address are not the same.
    type: boolean
    readOnly: true
  hasMismatchedBankCountry:
    description: Specifies if the customer's bank country and geo-IP address are not the same.
    type: boolean
    readOnly: true
  hasMismatchedTimeZone:
    description: Specifies if the customer's browser time zone and the IP address associated time zone are not the same.
    type: boolean
    readOnly: true
  hasMismatchedHolderName:
    description: Specifies if the customer's billing address name and primary address name are not the same.
    type: boolean
    readOnly: true
  hasFakeName:
    description: Specifies if the holder name seems fake.
    type: boolean
    readOnly: true
  isHighRiskCountry:
    description: Specifies if the geo-IP country, or the customer's billing country, is considered a high risk country.
    type: boolean
    readOnly: true
  paymentInstrumentVelocity:
    description: Number of transactions for this payment instrument, based on fingerprint, in the last 24 hours.
    type: integer
    readOnly: true
  declinedPaymentInstrumentVelocity:
    description: Number of declined transactions for this payment instrument fingerprint in the last 24 hours.
    type: integer
    readOnly: true
  deviceVelocity:
    description: Number of transactions for this device, based on fingerprint, in the last 24 hours.
    type: integer
    readOnly: true
  ipVelocity:
    description:  Number of transactions for this IP address in the last 24 hours.
    type: integer
    readOnly: true
  emailVelocity:
    description: Number of transactions for this email address in the last 24 hours.
    type: integer
    readOnly: true
  billingAddressVelocity:
    description: Number of transactions for this billing address in the last 24 hours.
    type: integer
    readOnly: true
  paymentInstrumentApprovedTransactionCount:
    description: Number of approved transactions for this payment instrument.
    type: integer
    readOnly: true
  score:
    description: |-
      Computed risk score based on IP risk data,
      such as: `isVpn`, `isTor`, and `isProxy`.
    type: integer
    readOnly: true
