type: object
allOf:
  - $ref: ../../Subscription/SubscriptionCancellationState.yaml
  - $ref: ./StorefrontOrderMetadata.yaml
  - properties:
      id:
        type: string
        description: ID of the order.
        readOnly: true
        maxLength: 50
        example: ord_01GYJPRKHBD6ZYHH897QCJMBS4
      orderType:
        description: |-
          Specifies the type of order.
          An order may be a subscription or a one-time purchase.
        type: string
        enum:
          - subscription-order
          - one-time-order
        default: subscription-order
      billingStatus:
        description: |-
          Billing status of the most recent invoice.
          This value may help you to determine if you should change the service status of the service,
          such as suspending the service.
        type: string
        readOnly: true
        enum:
          - draft
          - unpaid
          - past-due
          - abandoned
          - paid
          - voided
          - refunded
          - disputed
          - partially-refunded
          - partially-paid
      websiteId:
        x-sortable: true
        x-basic: true
        allOf:
          - $ref: ../../WebsiteId.yaml
      currency:
        description: Currency of the order.
        readOnly: true
        allOf:
          - $ref: ../../../schemas/CurrencyCode.yaml
      initialInvoiceId:
        type: string
        description: ID of the initial invoice.
        readOnly: true
        maxLength: 50
        example: in_0YVF9605RKC62BP14NE2R7V2XT
      recentInvoiceId:
        type: string
        description: |-
          ID of the most recently issued invoice.
          The invoice might not be `paid` yet.
        readOnly: true
        maxLength: 50
        example: in_0YVF9605RKC62BP14NE2R7V2XT
      items:
        description: Item details.
        type: array
        minItems: 1
        items:
          $ref: ../../Subscription/OrderItem.yaml
      deliveryAddress:
        description: Delivery address of the order.
        nullable: true
        type: object
        allOf:
          - $ref: ../../Contact/ContactObject.yaml
      billingAddress:
        description: Billing address of the order.
        nullable: true
        type: object
        allOf:
          - $ref: ../../Contact/ContactObject.yaml
      activationTime:
        description: Date and time when the order is activated.
        x-sortable: true
        allOf:
          - $ref: ../../ServerTimestamp.yaml
      voidTime:
        description: Date and time when the order is voided.
        allOf:
          - $ref: ../../ServerTimestamp.yaml
      abandonTime:
        type: string
        description: |-
          Date and time when the pending order is automatically abandoned.
          If this value is not passed during order creation,
          a [pending order TTL](https://all-rebilly.redoc.ly/tag/Organizations/operation/PatchOrganization/#!path=settings/billing/pendingOrderTtl&t=request) setting is used to calculate the value.
        format: date-time
        nullable: true
      couponIds:
        type: array
        nullable: true
        description: |-
          List of coupons to redeem on the customer and restrict to this order.

          For more information, see [Coupons](https://www.rebilly.com/docs/settings/coupons-and-discounts/).

          This parameter uses the following logic:

          - If this parameter is not supplied, applied coupons are not changed.
          - If an empty array is supplied, all applied coupon redemptions are canceled.
          - If a list of coupons is supplied, unapplied coupons in the list are applied.
            Coupons that have already been applied do not change state.
            Applied coupons that are not supplied in list are canceled.

          If the list of applied coupons on a pending order is changed by this parameter during an order update, the invoice for the order is reissued.
        writeOnly: true
        items:
          type: string
          description: ID of the coupon.
      poNumber:
        description: Purchase order number displayed on the issued invoices.
        nullable: true
        example: PO123456
        type: string
      shipping:
        $ref: ../../Shipping.yaml
      notes:
        description: Notes for the customer displayed on the order invoice.
        type: string
      status:
        description: |-
          Status of the subscription service.
          A subscription starts in the `pending` status, and becomes `active` when the service period begins.
        type: string
        readOnly: true
        enum:
          - pending
          - active
          - abandoned
          - canceled
          - churned
          - paused
          - voided
          - completed
          - trial-ended
      inTrial:
        description: Specifies if the subscription is currently in a trial period.
        type: boolean
        readOnly: true
      trial:
        type: object
        description: |-
          Trial details.
          To use plan defaults do not send the `trial` key, or send a `null` value.
        properties:
          enabled:
            description: |-
              Specifies if there is a trial for this subscription.
              Plans without trial prices are free trials.
            type: boolean
          endTime:
            description: |-
              Time and date when the trial ends.
              If a trial is enabled on this subscription, a value must be provided.
            type: string
            format: date-time
      isTrialOnly:
        description: |-
          Specifies if a subscription ends after a trial period.
          If this value is `true`, recurring settings are ignored.
        type: boolean
        default: false
      invoiceTimeShift:
        description: |-
          Shifts issue time and due time of invoices for this subscription.

          This setting overrides plan settings.
          To use plan settings, set this value to `null`.

          To use multiple plans in one subscription,
          all plans must have the same billing period,
          this property enables the customer to subscribe to different plans.
        nullable: true
        type: object
        example: null
        allOf:
          - $ref: ../../Invoices/InvoiceTimeShift.yaml
      recurringInterval:
        type: object
        description: |-
          Recurring interval to override plan settings.
          To use plan settings, set this value to `null`.

          To use multiple plans in one subscription,
          all plans must have the same same recurring period length,
          this property enables the customer to subscribe to different plans.
        nullable: true
        example: null
        properties:
          periodAnchorInstruction:
            $ref: ../../Scheduling/ServicePeriodAnchorInstruction.yaml
      autopay:
        description: |-
          Specifies if payment attempts are made automatically.
          If autopay is enabled, the payment is retrieved from the customer on the renewal date using the payment instrument that is set at `paymentInstrumentId`,
          or the default payment instrument on the subscription.
        type: boolean
        default: true
      startTime:
        description: |-
          Date and time when the subscription starts.
          If this value is `null`, the current time is used.
          This value cannot be more than one service period in the past.
        nullable: true
        x-sortable: true
        x-basic: true
        example: null
        type: string
        format: date-time
      endTime:
        description: Date and time when the subscription ends.
        x-sortable: true
        type: string
        format: date-time
        readOnly: true
      renewalTime:
        description: Date and time when the subscription renews.
        type: string
        x-sortable: true
        x-basic: true
        format: date-time
      rebillNumber:
        description: Current billing period number.
        type: integer
        readOnly: true
        x-sortable: true
      lineItems:
        description: Subscription line items which queue until the next renewal (or interim) invoice is issued for the subscription.
        readOnly: true
        type: array
        deprecated: true
        items:
          $ref: ../../Subscription/OrderLineItem.yaml
      lineItemSubtotal:
        type: object
        readOnly: true
        description: |-
          Subtotal of line items in this subscription (signed value).
          If credits exceed debits, this value is a negative number.
        properties:
          currency:
            $ref: ../../CurrencyCode.yaml
          amount:
            type: number
            x-type: Money
            x-sortable: true
            description: Amount of the subtotal.
            format: double
            example: 49.95
      paymentInstrumentId:
        type: string
        description: |-
          ID of the payment instrument to use for autopay.
          If this value is not provided, or if the payment instrument is inactive,
          the customer's default payment instrument is used.
        nullable: true
        maxLength: 50
        example: inst_0YVB8KPKNXCBR9EDX7JHSED75N
