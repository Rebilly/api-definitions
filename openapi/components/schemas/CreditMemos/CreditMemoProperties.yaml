id:
  description: Credit memo ID.
  readOnly: true
  allOf:
    - $ref: ../ResourceId.yaml
invoiceId:
  description: ID of the invoice which the credit memo is issued upon.
  nullable: true
  allOf:
    - $ref: ../ResourceId.yaml
customerId:
  $ref: ../CustomerId.yaml
number:
  description: An auto-incrementing number based on the sequence of credit memos for any particular customer.
  readOnly: true
  type: integer
allocations:
  type: array
  items:
    type: object
    properties:
      transactions:
        type: array
        items:
          type: object
          properties:
            transactionId:
              description: ID of the transaction that the credit memo is allocated to.
              allOf:
                - $ref: ../ResourceId.yaml
            amount:
              description: |-
                Amount of credit that is allocated from the credit memo to the transaction.
                This value cannot exceed the unused amount of the credit memo or the transaction amount.
                If the `amount` value is not supplied, the lesser of the following two values is used:
                - The unused amount of the credit memo.
                - The transaction amount.
              type: number
              format: double
            currency:
              readOnly: true
              allOf:
                - $ref: ../CurrencyCode.yaml
            createdTime:
              description: Credit memo allocation time.
              readOnly: true
              allOf:
                - $ref: ../ServerTimestamp.yaml
            updatedTime:
              $ref: ../UpdatedTime.yaml
items:
  type: array
  items:
    type: object
    required:
      - unitPrice
      - quantity
    properties:
      id:
        description: Credit memo item ID.
        readOnly: true
        allOf:
          - $ref: ../ResourceId.yaml
      invoiceItemId:
        description: ID of the invoice item on which the the credit item is referenced.
        nullable: true
        allOf:
          - $ref: ../ResourceId.yaml
      description:
        description: Description of the credit memo item.
        type: string
      unitPrice:
        description: Price of the credit memo item.
        type: number
        format: double
      quantity:
        description: Quantity of the credit memo item.
        type: integer
      price:
        description: Credit memo item's total price.
        type: number
        format: double
        readOnly: true
      productId:
        description: The related product's ID.
        nullable: true
        allOf:
          - $ref: ../ResourceId.yaml
      planId:
        description: The related plan's ID.
        nullable: true
        allOf:
          - $ref: ../ResourceId.yaml
status:
  type: string
  description: Status of the credit memo.
  readOnly: true
  enum:
    - issued
    - applied
    - partially-applied
    - voided
  x-enumDescriptions:
    issued: The credit memo is available with a full amount to be applied.
    applied: All the amount of the credit memo has been applied, no more credit can be created from it.
    partially-applied: >-
      Some amount of the credit memo has been applied,
      credit of amount `unusedAmount` can be created from it.
    voided: >-
      Some credit has or hasn't been created from the credit memo,
      but the credit memo cannot be used anymore.
reason:
  description: Credit memo reason code.
  type: string
  enum:
    - return
    - product-unsatisfactory
    - order-change
    - order-cancellation
    - chargeback
    - write-off
    - waiver
    - customer-credit
    - other
description:
  type: string
  x-basic: true
  description: A public description (visible to customers) clarifying the purpose of the credit memo.
currency:
  $ref: ../CurrencyCode.yaml
shippingAmount:
  description: The (invoice's) shipping amount to credit.
  type: number
  format: double
  default: 0.00
  x-type: Money
taxAmount:
  description: The (invoice's) tax amount to credit.
  type: number
  format: double
  default: 0.00
  x-type: Money
totalAmount:
  description: The sum of all credits in the credit memo (items, shipping, tax).
  readOnly: true
  type: number
  format: double
  default: 0.00
  x-type: Money
unusedAmount:
  description: The amount of `totalAmount` which hasn't been allocated anywhere yet.
  readOnly: true
  type: number
  format: double
  default: 0.00
  x-type: Money
revision:
  type: integer
  readOnly: true
  description: Increments when the credit memo is modified.
createdTime:
  description: Credit memo created time.
  x-sortable: true
  allOf:
    - $ref: ../ServerTimestamp.yaml
updatedTime:
  $ref: ../UpdatedTime.yaml
_links:
  type: array
  description: Related resource links.
  readOnly: true
  items:
    anyOf:
      - $ref: ../../schemas/Links/SelfLink.yaml
      - $ref: ../../schemas/Links/CustomerLink.yaml
      - $ref: ../../schemas/Links/InvoiceLink.yaml
